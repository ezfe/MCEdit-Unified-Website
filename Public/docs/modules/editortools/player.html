<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>editortools.player &mdash; MCEdit-Unified v1.5.6.0 documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="../../static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../../static/css/bootstrap3/bootswatch-yeti.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" href="../../static/css/adjust_theme/bootswatch-yeti.css" type="text/css" />

<link rel="stylesheet" href="../../static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../../static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     'v1.5.6.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../../static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../static/underscore.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <script type="text/javascript" src="../../static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../../static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../../static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="shortcut icon" href="../../static/favicon.ico"/>
    <link rel="top" title="MCEdit-Unified v1.5.6.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">MCEdit-Unified v1.5.6.0 documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">

            
              <li><a href="../../py-modindex.html" title="Python Module Index" >modules </a></li>
              <li><a href="../../genindex.html" title="General Index" accesskey="I">index </a></li>
              <li><a href="../index.html" accesskey="U">Module code</a></li>
            

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
    <p class="logo"><a href="../../index.html">
      <img class="logo" src="../../static/favicon.png" alt="Logo"/>
    </a></p>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="../../search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <h1>Source code for editortools.player</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Copyright (c) 2010-2012 David Rio Vierra</span>

<span class="sd">Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="sd">purpose with or without fee is hereby granted, provided that the above</span>
<span class="sd">copyright notice and this permission notice appear in all copies.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="sd">WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="sd">MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="sd">ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="sd">WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="sd">ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="sd">OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.&quot;&quot;&quot;</span>
<span class="c">#-# Modifiedby D.C.-G. for translation purpose</span>
<span class="kn">from</span> <span class="nn">OpenGL</span> <span class="kn">import</span> <span class="n">GL</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">albow</span> <span class="kn">import</span> <span class="n">TableView</span><span class="p">,</span> <span class="n">TableColumn</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="n">Button</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">CheckBox</span><span class="p">,</span> <span class="n">AttrRef</span><span class="p">,</span> <span class="n">Row</span><span class="p">,</span> <span class="n">ask</span><span class="p">,</span> <span class="n">alert</span><span class="p">,</span> <span class="n">input_text_buttons</span><span class="p">,</span> <span class="n">TabPanel</span>
<span class="kn">from</span> <span class="nn">albow.table_view</span> <span class="kn">import</span> <span class="n">TableRowView</span>
<span class="kn">from</span> <span class="nn">albow.translate</span> <span class="kn">import</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">editortools.editortool</span> <span class="kn">import</span> <span class="n">EditorTool</span>
<span class="kn">from</span> <span class="nn">editortools.tooloptions</span> <span class="kn">import</span> <span class="n">ToolOptions</span>
<span class="kn">from</span> <span class="nn">glbackground</span> <span class="kn">import</span> <span class="n">Panel</span>
<span class="kn">from</span> <span class="nn">glutils</span> <span class="kn">import</span> <span class="n">DisplayList</span>
<span class="kn">from</span> <span class="nn">mceutils</span> <span class="kn">import</span> <span class="n">loadPNGTexture</span><span class="p">,</span> <span class="n">alertException</span><span class="p">,</span> <span class="n">drawTerrainCuttingWire</span><span class="p">,</span> <span class="n">drawCube</span>
<span class="kn">from</span> <span class="nn">operation</span> <span class="kn">import</span> <span class="n">Operation</span>
<span class="kn">import</span> <span class="nn">pymclevel</span>
<span class="kn">from</span> <span class="nn">pymclevel.box</span> <span class="kn">import</span> <span class="n">BoundingBox</span><span class="p">,</span> <span class="n">FloatBox</span>
<span class="kn">from</span> <span class="nn">pymclevel</span> <span class="kn">import</span> <span class="n">nbt</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">version_utils</span> <span class="kn">import</span> <span class="n">PlayerCache</span>
<span class="kn">from</span> <span class="nn">nbtexplorer</span> <span class="kn">import</span> <span class="n">loadFile</span><span class="p">,</span> <span class="n">saveFile</span><span class="p">,</span> <span class="n">NBTExplorerToolPanel</span>
<span class="kn">import</span> <span class="nn">pygame</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<div class="viewcode-block" id="PlayerRemoveOperation"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerRemoveOperation">[docs]</a><span class="k">class</span> <span class="nc">PlayerRemoveOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
    <span class="n">undoTag</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="s">&quot;Player (Single Player)&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlayerRemoveOperation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span> <span class="o">=</span> <span class="n">tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span> <span class="o">=</span> <span class="n">PlayerCache</span><span class="p">()</span>

<div class="viewcode-block" id="PlayerRemoveOperation.perform"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerRemoveOperation.perform">[docs]</a>    <span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordUndo</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">saving</span><span class="p">:</span>
            <span class="n">alert</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Cannot perform action while saving is taking place&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Are you sure you want to delete the default player?&quot;</span><span class="p">),</span> <span class="p">[</span><span class="s">&quot;Yes&quot;</span><span class="p">,</span> <span class="s">&quot;Cancel&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s">&quot;Cancel&quot;</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="s">&quot;Player&quot;</span>

        <span class="k">if</span> <span class="n">recordUndo</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">undoTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerTag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span><span class="p">:</span>
                <span class="c">#self.tool.panel.players.remove(version_utils.getPlayerNameFromUUID(self.player))</span>
                <span class="c">#self.tool.panel.players.remove(self.playercache.getPlayerInfo(self.player)[0])</span>
                <span class="nb">str</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">&quot;Player (Single Player)&quot;</span><span class="p">)</span>

            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">players</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="c">#if len(self.tool.panel.players) == 0:</span>
            <span class="c">#    self.tool.hidePanel()</span>
            <span class="c">#    self.tool.showPanel()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">hidePanel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">showPanel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">root_tag</span><span class="p">[</span><span class="s">&quot;Data&quot;</span><span class="p">][</span><span class="s">&quot;Player&quot;</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="PlayerRemoveOperation.undo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerRemoveOperation.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoTag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerTagCache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">undoTag</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">root_tag</span><span class="p">[</span><span class="s">&quot;Data&quot;</span><span class="p">][</span><span class="s">&quot;Player&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">undoTag</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
                <span class="c">#if self.player != &quot;Player&quot;:</span>
                <span class="c">#    self.tool.panel.players.append(self.playercache.getPlayerInfo(self.player)[0])</span>
                <span class="c">#else:</span>
                <span class="c">#    self.tool.panel.players.append(&quot;Player (Single Player)&quot;)</span>

                <span class="k">if</span> <span class="s">&quot;[No players]&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">&quot;[No players]&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">hidePanel</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">showPanel</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PlayerRemoveOperation.redo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerRemoveOperation.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="PlayerAddOperation"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerAddOperation">[docs]</a><span class="k">class</span> <span class="nc">PlayerAddOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
    <span class="n">playerTag</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlayerAddOperation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span> <span class="o">=</span> <span class="n">tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span> <span class="o">=</span> <span class="n">PlayerCache</span><span class="p">()</span>

<div class="viewcode-block" id="PlayerAddOperation.perform"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerAddOperation.perform">[docs]</a>    <span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordUndo</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">initial</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">allowed_chars</span> <span class="o">=</span> <span class="s">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&quot;</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">input_text_buttons</span><span class="p">(</span><span class="s">&quot;Enter a Player Name: &quot;</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">allowed_chars</span><span class="o">=</span><span class="n">allowed_chars</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="n">alert</span><span class="p">(</span><span class="s">&quot;Name too long. Maximum name length is 16.&quot;</span><span class="p">)</span>
                <span class="n">initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">alert</span><span class="p">(</span><span class="s">&quot;Name too short. Minimum name length is 1.&quot;</span><span class="p">)</span>
                <span class="n">initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
            
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&quot;&lt;Unknown UUID&gt;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s">&quot;Could not get {}&#39;s UUID. Please make sure that you are connected to the internet and that the player </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> exists.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">),</span> <span class="p">[</span><span class="s">&quot;Enter UUID manually&quot;</span><span class="p">,</span> <span class="s">&quot;Cancel&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s">&quot;Enter UUID manually&quot;</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="n">input_text_buttons</span><span class="p">(</span><span class="s">&quot;Enter a Player UUID: &quot;</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerFromUUID</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ask</span><span class="p">(</span><span class="s">&quot;UUID was not found. Continue anyways?&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;Cancel&quot;</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
            <span class="n">alert</span><span class="p">(</span><span class="s">&quot;Player already exists in this World.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newPlayer</span><span class="p">()</span>

        <span class="c">#if self.tool.panel:</span>
        <span class="c">#    self.tool.panel.players.append(self.player)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">oldPlayerFolderFormat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerTagCache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="c">#if self.tool.panel:</span>
                <span class="c">#self.tool.panel.player_UUID[self.player] = self.player</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerTagCache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">][(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadPNGTexture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerSkin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">recordMove</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">hidePanel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">showPanel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">nonSavedPlayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">inOtherDimension</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlayerAddOperation.newPlayer"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerAddOperation.newPlayer">[docs]</a>    <span class="k">def</span> <span class="nf">newPlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">playerTag</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Compound</span><span class="p">()</span>

        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;AttackTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;DeathTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Fire&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Health&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;HurtTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Short</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;FallDistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;OnGround&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Byte</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Dimension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">)</span>

        <span class="n">playerTag</span><span class="p">[</span><span class="s">&quot;Inventory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_List</span><span class="p">()</span>

        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Motion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_List</span><span class="p">([</span><span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Double</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="n">spawn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
        <span class="n">spawnX</span> <span class="o">=</span> <span class="n">spawn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">spawnZ</span> <span class="o">=</span> <span class="n">spawn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">blockAt</span><span class="p">(</span><span class="n">spawnX</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">spawnZ</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">Height</span><span class="p">)]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">Height</span>
        <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">blocks</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">index</span>
                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">spawnY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">Height</span> <span class="o">-</span> <span class="n">i</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Pos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_List</span><span class="p">([</span><span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Double</span><span class="p">([</span><span class="n">spawnX</span><span class="p">,</span> <span class="n">spawnY</span><span class="p">,</span> <span class="n">spawnZ</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="n">playerTag</span><span class="p">[</span><span class="s">&#39;Rotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_List</span><span class="p">([</span><span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Float</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">nbt</span><span class="o">.</span><span class="n">TAG_Float</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>

        <span class="k">return</span> <span class="n">playerTag</span>
</div>
<div class="viewcode-block" id="PlayerAddOperation.undo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerAddOperation.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="c">#self.tool.panel.players.remove(self.player)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">hidePanel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">showPanel</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">nonSavedPlayers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">nonSavedPlayers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PlayerAddOperation.redo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerAddOperation.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerTagCache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
                <span class="c">#self.tool.panel.players.append(self.uuid)</span>
                <span class="c">#self.tool.panel.player_UUID[self.player] = self.uuid</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadPNGTexture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerSkin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerTag</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">nonSavedPlayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="PlayerMoveOperation"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerMoveOperation">[docs]</a><span class="k">class</span> <span class="nc">PlayerMoveOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
    <span class="n">undoPos</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">redoPos</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="s">&quot;Player&quot;</span><span class="p">,</span> <span class="n">yp</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlayerMoveOperation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span> <span class="o">=</span> <span class="n">tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yp</span> <span class="o">=</span> <span class="n">yp</span>

<div class="viewcode-block" id="PlayerMoveOperation.perform"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerMoveOperation.perform">[docs]</a>    <span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordUndo</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">saving</span><span class="p">:</span>
            <span class="n">alert</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Cannot perform action while saving is taking place&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoDim</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoYP</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t get player position! ({0!r})&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

            <span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yp</span>
            <span class="k">if</span> <span class="n">yaw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">pitch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">level</span><span class="o">.</span><span class="n">setPlayerOrientation</span><span class="p">((</span><span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerDimension</span><span class="p">(</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">except</span> <span class="n">pymclevel</span><span class="o">.</span><span class="n">PlayerNotFound</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Player move failed: &quot;</span><span class="p">,</span> <span class="n">e</span>
</div>
<div class="viewcode-block" id="PlayerMoveOperation.undo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerMoveOperation.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redoDim</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redoYP</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t get player position! ({0!r})&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoDim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoYP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PlayerMoveOperation.redo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerMoveOperation.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoDim</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoYP</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">getPlayerOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t get player position! ({0!r})&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoDim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoYP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PlayerMoveOperation.bufferSize"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerMoveOperation.bufferSize">[docs]</a>    <span class="k">def</span> <span class="nf">bufferSize</span><span class="p">():</span>
        <span class="k">return</span> <span class="mi">20</span>

</div></div>
<div class="viewcode-block" id="SpawnPositionInvalid"><a class="viewcode-back" href="../../editortools.html#editortools.player.SpawnPositionInvalid">[docs]</a><span class="k">class</span> <span class="nc">SpawnPositionInvalid</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="okayAt63"><a class="viewcode-back" href="../../editortools.html#editortools.player.okayAt63">[docs]</a><span class="k">def</span> <span class="nf">okayAt63</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;blocks 63 or 64 must be occupied&quot;&quot;&quot;</span>
    <span class="c"># return level.blockAt(pos[0], 63, pos[2]) != 0 or level.blockAt(pos[0], 64, pos[2]) != 0</span>
    <span class="k">return</span> <span class="bp">True</span>

</div>
<div class="viewcode-block" id="okayAboveSpawn"><a class="viewcode-back" href="../../editortools.html#editortools.player.okayAboveSpawn">[docs]</a><span class="k">def</span> <span class="nf">okayAboveSpawn</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;3 blocks above spawn must be open&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">level</span><span class="o">.</span><span class="n">blockAt</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>

</div>
<div class="viewcode-block" id="positionValid"><a class="viewcode-back" href="../../editortools.html#editortools.player.positionValid">[docs]</a><span class="k">def</span> <span class="nf">positionValid</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">okayAt63</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="ow">and</span> <span class="n">okayAboveSpawn</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">EnvironmentError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="PlayerSpawnMoveOperation"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnMoveOperation">[docs]</a><span class="k">class</span> <span class="nc">PlayerSpawnMoveOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
    <span class="n">undoPos</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">redoPos</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlayerSpawnMoveOperation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">tool</span><span class="p">,</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">False</span>

<div class="viewcode-block" id="PlayerSpawnMoveOperation.perform"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnMoveOperation.perform">[docs]</a>    <span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordUndo</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">saving</span><span class="p">:</span>
            <span class="n">alert</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Cannot perform action while saving is taking place&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if isinstance(level, pymclevel.MCInfdevOldLevel):</span>
<span class="sd">            if not positionValid(level, self.pos):</span>
<span class="sd">                if config.spawn.spawnProtection.get():</span>
<span class="sd">                    raise SpawnPositionInvalid(</span>
<span class="sd">                        &quot;You cannot have two air blocks at Y=63 and Y=64 in your spawn point&#39;s column. Additionally, you cannot have a solid block in the three blocks above your spawn point. It&#39;s weird, I know.&quot;)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
        <span class="n">level</span><span class="o">.</span><span class="n">setPlayerSpawnPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canUndo</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="PlayerSpawnMoveOperation.undo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnMoveOperation.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerSpawnPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PlayerSpawnMoveOperation.redo"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnMoveOperation.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">undoPos</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
            <span class="n">level</span><span class="o">.</span><span class="n">setPlayerSpawnPosition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoPos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="PlayerPositionPanel"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionPanel">[docs]</a><span class="k">class</span> <span class="nc">PlayerPositionPanel</span><span class="p">(</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="n">Panel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;Panel.PlayerPositionPanel&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span> <span class="o">=</span> <span class="n">tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;UUID&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span> <span class="o">=</span> <span class="n">PlayerCache</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="s">&#39;players&#39;</span><span class="p">):</span>
            <span class="n">players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span> <span class="ow">or</span> <span class="p">[</span><span class="s">&quot;[No players]&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">oldPlayerFolderFormat</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span> <span class="ow">and</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;[No players]&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">player</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span><span class="p">:</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">worldFolder</span><span class="o">.</span><span class="n">getFolderPath</span><span class="p">(</span><span class="s">&quot;playerdata&quot;</span><span class="p">),</span> <span class="n">player</span><span class="o">+</span><span class="s">&quot;.dat&quot;</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">worldFolder</span><span class="o">.</span><span class="n">getFolderPath</span><span class="p">(</span><span class="s">&quot;playerdata&quot;</span><span class="p">),</span> <span class="n">player</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;.dat&quot;</span><span class="p">))</span>
                            <span class="n">player</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerInfo</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">use_old_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                        <span class="c">#self.player_UUID[data[0]] = data[1]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="c">#self.player_UUID[player] = data</span>
                <span class="k">if</span> <span class="s">&quot;Player&quot;</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
                    <span class="c">#self.player_UUID[&quot;Player (Single Player)&quot;] = &quot;Player&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Player&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Player (Single Player)&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&quot;[No players]&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">player_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;[No players]&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;[No players]&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">players</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Player (Single Player)&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="o">=</span> <span class="n">players</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="n">TabPanel</span><span class="p">()</span>
        <span class="n">tab_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">tab_height</span>

        <span class="n">max_height</span> <span class="o">=</span> <span class="n">tab_height</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">subwidgets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">margin</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="c">#-# Uncomment the following line to have a maximum height for this panel.</span>
        <span class="c"># max_height = min(max_height, 500)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">editNBTDataButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Edit NBT&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">editNBTData</span><span class="p">,</span> <span class="n">tooltipText</span><span class="o">=</span><span class="s">&quot;Open the NBT Explorer to edit player&#39;s attributes and inventory&quot;</span><span class="p">)</span>
        <span class="n">addButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Add&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">addPlayer</span><span class="p">)</span>
        <span class="n">removeButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Remove&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">removePlayer</span><span class="p">)</span>
        <span class="n">gotoButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Goto&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">gotoPlayer</span><span class="p">)</span>
        <span class="n">gotoCameraButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Goto View&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">gotoPlayerCamera</span><span class="p">)</span>
        <span class="n">moveButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Move&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movePlayer</span><span class="p">)</span>
        <span class="n">moveToCameraButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Align to Camera&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">movePlayerToCamera</span><span class="p">)</span>
        <span class="n">reloadSkin</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Reload Skins&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">reloadSkins</span><span class="p">,</span> <span class="n">tooltipText</span><span class="o">=</span><span class="s">&quot;This pulls skins from the online server, so this may take a while&quot;</span><span class="p">)</span>

        <span class="n">btns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">editNBTDataButton</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">pymclevel</span><span class="o">.</span><span class="n">leveldbpocket</span><span class="o">.</span><span class="n">PocketLeveldbWorld</span><span class="p">):</span>
            <span class="n">btns</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">addButton</span><span class="p">,</span> <span class="n">removeButton</span><span class="p">])</span>
        <span class="n">btns</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">gotoButton</span><span class="p">,</span> <span class="n">gotoCameraButton</span><span class="p">,</span> <span class="n">moveButton</span><span class="p">,</span> <span class="n">moveToCameraButton</span><span class="p">,</span> <span class="n">reloadSkin</span><span class="p">])</span>
        <span class="n">btns</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">btns</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">max_height</span> <span class="o">-</span> <span class="n">btns</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">margin</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">get_linesize</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">close</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">show_page</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span> <span class="o">=</span> <span class="n">NBTExplorerToolPanel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">nbtObject</span><span class="o">=</span><span class="p">{},</span> <span class="n">height</span><span class="o">=</span><span class="n">max_height</span><span class="p">,</span> \
                                            <span class="n">close_text</span><span class="o">=</span><span class="s">&quot;Go Back&quot;</span><span class="p">,</span> <span class="n">no_header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">close_action</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                                            <span class="n">load_text</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="s">&quot;NBT Data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">set_rect</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">margin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="o">.</span><span class="n">_rect</span><span class="p">))</span>

        <span class="n">tableview</span> <span class="o">=</span> <span class="n">TableView</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">get_linesize</span><span class="p">()</span> <span class="o">*</span> <span class="mf">2.5</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">get_linesize</span><span class="p">(),</span>
                              <span class="n">header_height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">get_linesize</span><span class="p">(),</span>
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">TableColumn</span><span class="p">(</span><span class="s">&quot;Player Name(s):&quot;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">margin</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span>
                                       <span class="n">TableColumn</span><span class="p">(</span><span class="s">&quot;Player UUID(s):&quot;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">margin</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)))],</span>
                              <span class="p">)</span>
        <span class="n">tableview</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tableview</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">])</span>
        <span class="n">tableview</span><span class="o">.</span><span class="n">row_data</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="n">tableview</span><span class="o">.</span><span class="n">row_is_selected</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">tableview</span><span class="o">.</span><span class="n">index</span>
        <span class="n">tableview</span><span class="o">.</span><span class="n">zebra_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">selectTableRow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
            <span class="n">tableview</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>

        <span class="n">tableview</span><span class="o">.</span><span class="n">click_row</span> <span class="o">=</span> <span class="n">selectTableRow</span>

        <span class="k">def</span> <span class="nf">mouse_down</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">num_clicks</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editNBTData</span><span class="p">()</span>
            <span class="n">TableRowView</span><span class="o">.</span><span class="n">mouse_down</span><span class="p">(</span><span class="n">tableview</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="n">tableview</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">mouse_down</span> <span class="o">=</span> <span class="n">mouse_down</span>

        <span class="n">tableview</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">tooltipText</span> <span class="o">=</span> <span class="s">&quot;Double-click or use the button below to edit the NBT Data.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">tableview</span>

        <span class="n">col</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="n">col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="n">tableview</span><span class="p">,</span> <span class="n">btns</span><span class="p">],</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="s">&quot;Players&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">show_page</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_height</span> <span class="o">=</span> <span class="n">max_height</span>

<div class="viewcode-block" id="PlayerPositionPanel.editNBTData"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionPanel.editNBTData">[docs]</a>    <span class="k">def</span> <span class="nf">editNBTData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedPlayer</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">&#39;Player (Single Player)&#39;</span><span class="p">:</span>
            <span class="n">alert</span><span class="p">(</span><span class="s">&quot;Not yet implemented.</span><span class="se">\n</span><span class="s">Use the NBT Explorer to edit this player.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">player</span> <span class="o">==</span> <span class="s">&#39;[No players]&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerTag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectedPlayer</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">player</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">remove_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="p">)</span>

                <span class="k">def</span> <span class="nf">close</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">show_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span> <span class="o">=</span> <span class="n">NBTExplorerToolPanel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool</span><span class="o">.</span><span class="n">editor</span><span class="p">,</span> <span class="n">nbtObject</span><span class="o">=</span><span class="n">player</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                              <span class="n">savePolicy</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dataKeyName</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                              <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_height</span><span class="p">,</span> <span class="n">no_header</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">close_text</span><span class="o">=</span><span class="s">&quot;Go Back&quot;</span><span class="p">,</span>
                                              <span class="n">close_action</span><span class="o">=</span><span class="n">close</span><span class="p">,</span> <span class="n">load_text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                              <span class="n">copy_data</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="p">,])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="s">&quot;NBT Data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">show_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alert</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Unable to load player </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedPlayer</span><span class="p">()))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">selectedPlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">oldPlayerFolderFormat</span><span class="p">:</span>
            <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player (Single Player)&quot;</span> <span class="ow">and</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;[No players]&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">player_UUID</span><span class="p">[</span><span class="s">&quot;UUID&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">player</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<div class="viewcode-block" id="PlayerPositionPanel.key_down"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionPanel.key_down">[docs]</a>    <span class="k">def</span> <span class="nf">key_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_key</span><span class="p">(</span><span class="s">&#39;key_down&#39;</span><span class="p">,</span> <span class="n">evt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlayerPositionPanel.dispatch_key"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionPanel.dispatch_key">[docs]</a>    <span class="k">def</span> <span class="nf">dispatch_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="s">&#39;key&#39;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;key_down&quot;</span><span class="p">:</span>
            <span class="n">keyname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">getKey</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">current_page</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&quot;Up&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">scroll_to_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&quot;Down&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">scroll_to_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&#39;Page down&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">num_rows</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&#39;Page up&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">num_rows</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&#39;Return&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedPlayer</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">editNBTData</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">cell_to_item_no</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">num_rows</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">cell_to_item_no</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">num_rows</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">scroll_to_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">current_page</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbtpage</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbttree</span><span class="o">.</span><span class="n">dispatch_key</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">evt</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="PlayerPositionTool"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool">[docs]</a><span class="k">class</span> <span class="nc">PlayerPositionTool</span><span class="p">(</span><span class="n">EditorTool</span><span class="p">):</span>
    <span class="n">surfaceBuild</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">toolIconName</span> <span class="o">=</span> <span class="s">&quot;player&quot;</span>
    <span class="n">tooltipText</span> <span class="o">=</span> <span class="s">&quot;Players&quot;</span>
    <span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">recordMove</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="PlayerPositionTool.reloadTextures"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.reloadTextures">[docs]</a>    <span class="k">def</span> <span class="nf">reloadTextures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charTex</span> <span class="o">=</span> <span class="n">loadPNGTexture</span><span class="p">(</span><span class="s">&#39;char.png&#39;</span><span class="p">)</span>
</div>
    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">addPlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerAddOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>

    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">removePlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span>

        <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;[No players]&quot;</span><span class="p">:</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerRemoveOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>

    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">movePlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span> <span class="o">!=</span> <span class="s">&quot;[No players]&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="s">&quot;Player&quot;</span>

    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">movePlayerToCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span><span class="p">:</span>
            <span class="n">player</span> <span class="o">=</span> <span class="s">&quot;Player&quot;</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;[No players]&quot;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraPosition</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">yaw</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">pitch</span>

            <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerMoveOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>

<div class="viewcode-block" id="PlayerPositionTool.delete_skin"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.delete_skin">[docs]</a>    <span class="k">def</span> <span class="nf">delete_skin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charTex</span>
</div>
    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">reloadSkins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#result = ask(&quot;This pulls skins from the online server, so this may take a while&quot;, [&quot;Ok&quot;, &quot;Cancel&quot;])</span>
        <span class="c">#if result == &quot;Ok&quot;:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span> <span class="ow">and</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">player</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadPNGTexture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerSkin</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="p">))</span>
            <span class="c">#self.markerList.call(self._drawToolMarkers)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Could not connect to the skins server, please check your Internet connection and try again.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="PlayerPositionTool.gotoPlayerCamera"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.gotoPlayerCamera">[docs]</a>    <span class="k">def</span> <span class="nf">gotoPlayerCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span><span class="p">:</span>
            <span class="n">player</span> <span class="o">=</span> <span class="s">&quot;Player&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerOrientation</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">gotoDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraPosition</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="n">p</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">stopMoving</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">pymclevel</span><span class="o">.</span><span class="n">PlayerNotFound</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="PlayerPositionTool.gotoPlayer"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.gotoPlayer">[docs]</a>    <span class="k">def</span> <span class="nf">gotoPlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">selectedPlayer</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">&quot;Player (Single Player)&quot;</span><span class="p">:</span>
            <span class="n">player</span> <span class="o">=</span> <span class="s">&quot;Player&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">pitch</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">pitch</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraVector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">_cameraVector</span><span class="p">()</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraVector</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">p</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">gotoDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraPosition</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">stopMoving</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">pymclevel</span><span class="o">.</span><span class="n">PlayerNotFound</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">EditorTool</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reloadTextures</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonSavedPlayers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">textureVerticesHead</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="c"># Backside of Head</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="c"># Bottom Left</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="c"># Top Left</span>
                <span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="c"># Top Right</span>
                <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="c"># Bottom Right</span>

                <span class="c"># Front of Head</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>

                <span class="c">#</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>

                <span class="c">#</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>

                <span class="c">#</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>

                <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>

            <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;f4&#39;</span><span class="p">)</span>
        
        <span class="n">textureVerticesHat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="mi">56</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">56</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">64</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                
                <span class="mi">48</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">48</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">40</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">40</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                
                <span class="mi">56</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">48</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">48</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">56</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                
                <span class="mi">48</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">40</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">48</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                
                <span class="mi">40</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">40</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                
                <span class="mi">48</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">56</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                <span class="mi">56</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                <span class="mi">48</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                
            <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;f4&#39;</span><span class="p">)</span>
        

        <span class="n">textureVerticesHead</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">textureVerticesHat</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">textureVerticesHead</span> <span class="o">*=</span> <span class="mi">4</span>
        <span class="n">textureVerticesHead</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
        
        <span class="n">textureVerticesHat</span> <span class="o">*=</span> <span class="mi">4</span>
        <span class="n">textureVerticesHat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">texVerts</span> <span class="o">=</span> <span class="p">(</span><span class="n">textureVerticesHead</span><span class="p">,</span> <span class="n">textureVerticesHat</span><span class="p">)</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">playerPos</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span> <span class="o">-</span><span class="mi">1</span><span class="p">:{},</span> <span class="mi">1</span><span class="p">:{}}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">revPlayerPos</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span> <span class="o">-</span><span class="mi">1</span><span class="p">:{},</span> <span class="mi">1</span><span class="p">:{}}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inOtherDimension</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[],</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playercache</span> <span class="o">=</span> <span class="n">PlayerCache</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span> <span class="o">=</span> <span class="n">DisplayList</span><span class="p">()</span>

    <span class="n">panel</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="PlayerPositionTool.showPanel"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.showPanel">[docs]</a>    <span class="k">def</span> <span class="nf">showPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">PlayerPositionPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">centery</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">subwidgets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">left</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlayerPositionTool.hidePanel"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.hidePanel">[docs]</a>    <span class="k">def</span> <span class="nf">hidePanel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="PlayerPositionTool.drawToolReticle"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.drawToolReticle">[docs]</a>    <span class="k">def</span> <span class="nf">drawToolReticle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">blockFaceUnderCursor</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span>

        <span class="c"># x,y,z=map(lambda p,d: p+d, pos, direction)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span><span class="p">],</span> <span class="n">dim</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>

        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span><span class="p">],</span> <span class="n">dim</span><span class="p">)</span>
        <span class="n">drawTerrainCuttingWire</span><span class="p">(</span><span class="n">BoundingBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">drawTerrainCuttingWire</span><span class="p">(</span><span class="n">BoundingBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="c">#drawTerrainCuttingWire( BoundingBox((x,y-2,z), (1,1,1)) )</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
</div>
    <span class="n">markerLevel</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="PlayerPositionTool.drawToolMarkers"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.drawToolMarkers">[docs]</a>    <span class="k">def</span> <span class="nf">drawToolMarkers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">drawPlayerHeads</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">markerLevel</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markerLevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_drawToolMarkers</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_drawToolMarkers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_MODELVIEW</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">players</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerPosition</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerOrientation</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">getPlayerDimension</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">inOtherDimension</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">revPlayerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                
                <span class="k">if</span> <span class="n">player</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">downloadPlayerSkins</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadPNGTexture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playercache</span><span class="o">.</span><span class="n">getPlayerSkin</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charTex</span>
                    
                <span class="k">if</span> <span class="n">dim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glPushMatrix</span><span class="p">()</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glTranslate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glRotate</span><span class="p">(</span><span class="o">-</span><span class="n">yaw</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glRotate</span><span class="p">(</span><span class="n">pitch</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span><span class="p">)</span>
                <span class="n">GL</span><span class="o">.</span><span class="n">glPopMatrix</span><span class="p">()</span>
                <span class="c"># GL.glEnable(GL.GL_BLEND)</span>
                <span class="n">drawTerrainCuttingWire</span><span class="p">(</span><span class="n">FloatBox</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
                                       <span class="n">c0</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                                       <span class="n">c1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="c">#GL.glDisable(GL.GL_BLEND)</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>

        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>

<div class="viewcode-block" id="PlayerPositionTool.drawCharacterHead"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.drawCharacterHead">[docs]</a>    <span class="k">def</span> <span class="nf">drawCharacterHead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">realCoords</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_CULL_FACE</span><span class="p">)</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">FloatBox</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        
        <span class="n">hat_origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.275</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">0.275</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="mf">0.275</span><span class="p">)</span>
        <span class="n">hat_size</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">)</span>
        <span class="n">hat_box</span> <span class="o">=</span> <span class="n">FloatBox</span><span class="p">(</span><span class="n">hat_origin</span><span class="p">,</span> <span class="n">hat_size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">realCoords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">realCoords</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;Player&quot;</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">downloadPlayerSkins</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">drawCube</span><span class="p">(</span><span class="n">box</span><span class="p">,</span>
                     <span class="n">texture</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">realCoords</span><span class="p">]],</span> <span class="n">textureVertices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">texVerts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>
            <span class="n">GL</span><span class="o">.</span><span class="n">glBlendFunc</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_SRC_ALPHA</span><span class="p">,</span> <span class="n">GL</span><span class="o">.</span><span class="n">GL_ONE_MINUS_SRC_ALPHA</span><span class="p">)</span>
            <span class="n">drawCube</span><span class="p">(</span><span class="n">hat_box</span><span class="p">,</span>
                     <span class="n">texture</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">playerTexture</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">playerPos</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">realCoords</span><span class="p">]],</span> <span class="n">textureVertices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">texVerts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drawCube</span><span class="p">(</span><span class="n">box</span><span class="p">,</span>
                     <span class="n">texture</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charTex</span><span class="p">,</span> <span class="n">textureVertices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">texVerts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_CULL_FACE</span><span class="p">)</span>

    <span class="c">#@property</span>
    <span class="c">#def statusText(self):</span>
    <span class="c">#    if not self.panel:</span>
    <span class="c">#        return &quot;&quot;</span>
    <span class="c">#    player = self.panel.selectedPlayer</span>
    <span class="c">#    if player == &quot;Player&quot;:</span>
    <span class="c">#        return &quot;Click to move the player&quot;</span>
<span class="c">#</span>
    <span class="c">#    return _(&quot;Click to move the player \&quot;{0}\&quot;&quot;).format(player)</span>
</div>
    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">mouseDown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.75</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerMoveOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordMove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
            <span class="n">addingMoving</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">performWithRetry</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>  <span class="c">#Prevent recording of Undo when adding player</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recordMove</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">addingMoving</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">addingMoving</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>

<div class="viewcode-block" id="PlayerPositionTool.keyDown"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.keyDown">[docs]</a>    <span class="k">def</span> <span class="nf">keyDown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="n">keyname</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;keyname&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">get_root</span><span class="p">()</span><span class="o">.</span><span class="n">getKey</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordMove</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_focused</span><span class="p">():</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">keyname</span> <span class="o">==</span> <span class="s">&quot;Escape&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recordMove</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">__class__</span> <span class="o">==</span> <span class="n">PlayerPositionPanel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">key_down</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlayerPositionTool.keyUp"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.keyUp">[docs]</a>    <span class="k">def</span> <span class="nf">keyUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="PlayerPositionTool.levelChanged"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerPositionTool.levelChanged">[docs]</a>    <span class="k">def</span> <span class="nf">levelChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
</div>
    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">toolSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showPanel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movingPlayer</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">toolReselected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gotoPlayer</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="PlayerSpawnPositionOptions"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionOptions">[docs]</a><span class="k">class</span> <span class="nc">PlayerSpawnPositionOptions</span><span class="p">(</span><span class="n">ToolOptions</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">):</span>
        <span class="n">ToolOptions</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;Panel.PlayerSpawnPositionOptions&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool</span> <span class="o">=</span> <span class="n">tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionCheckBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">AttrRef</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s">&quot;spawnProtection&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionLabel</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="s">&quot;Spawn Position Safety&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionLabel</span><span class="o">.</span><span class="n">mouse_down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionCheckBox</span><span class="o">.</span><span class="n">mouse_down</span>

        <span class="n">tooltipText</span> <span class="o">=</span> <span class="s">&quot;Minecraft will randomly move your spawn point if you try to respawn in a column where there are no blocks at Y=63 and Y=64. Only uncheck this box if Minecraft is changed.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionLabel</span><span class="o">.</span><span class="n">tooltipText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionCheckBox</span><span class="o">.</span><span class="n">tooltipText</span> <span class="o">=</span> <span class="n">tooltipText</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionCheckBox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtectionLabel</span><span class="p">))</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">((</span><span class="n">Label</span><span class="p">(</span><span class="s">&quot;Spawn Point Options&quot;</span><span class="p">),</span> <span class="n">row</span><span class="p">,</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;OK&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dismiss</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="PlayerSpawnPositionTool"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool">[docs]</a><span class="k">class</span> <span class="nc">PlayerSpawnPositionTool</span><span class="p">(</span><span class="n">PlayerPositionTool</span><span class="p">):</span>
    <span class="n">surfaceBuild</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">toolIconName</span> <span class="o">=</span> <span class="s">&quot;playerspawn&quot;</span>
    <span class="n">tooltipText</span> <span class="o">=</span> <span class="s">&quot;Move Spawn Point</span><span class="se">\n</span><span class="s">Right-click for options&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">PlayerPositionTool</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optionsPanel</span> <span class="o">=</span> <span class="n">PlayerSpawnPositionOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="PlayerSpawnPositionTool.toolEnabled"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool.toolEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">toolEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">dimNo</span> <span class="o">==</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="PlayerSpawnPositionTool.showPanel"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool.showPanel">[docs]</a>    <span class="k">def</span> <span class="nf">showPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Panel.PlayerSpawnPositionTool&#39;</span><span class="p">)</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s">&quot;Goto Spawn&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gotoSpawn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">shrink_wrap</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">centery</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">centery</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlayerSpawnPositionTool.gotoSpawn"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool.gotoSpawn">[docs]</a>    <span class="k">def</span> <span class="nf">gotoSpawn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraVector</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">p</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">cameraPosition</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">mainViewport</span><span class="o">.</span><span class="n">stopMoving</span><span class="p">()</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">statusText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;Click to set the spawn position.&quot;</span>

    <span class="n">spawnProtection</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">spawn</span><span class="o">.</span><span class="n">spawnProtection</span><span class="o">.</span><span class="n">property</span><span class="p">()</span>

<div class="viewcode-block" id="PlayerSpawnPositionTool.drawToolReticle"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool.drawToolReticle">[docs]</a>    <span class="k">def</span> <span class="nf">drawToolReticle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">blockFaceUnderCursor</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">p</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>

        <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">pymclevel</span><span class="o">.</span><span class="n">MCInfdevOldLevel</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spawnProtection</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">positionValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="o">*</span><span class="n">color</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCage</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>

        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCage</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">color2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">drawTerrainCuttingWire</span><span class="p">(</span><span class="n">BoundingBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">color2</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_drawToolMarkers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">playerSpawnPosition</span><span class="p">()</span>
        
        <span class="n">GL</span><span class="o">.</span><span class="n">glBlendFunc</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_SRC_ALPHA</span><span class="p">,</span> <span class="n">GL</span><span class="o">.</span><span class="n">GL_ONE_MINUS_SRC_ALPHA</span><span class="p">);</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">);</span>
        
        <span class="n">color</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">selectionColors</span><span class="o">.</span><span class="n">black</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.35</span><span class="p">,)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="o">*</span><span class="n">color</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glPolygonMode</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_FRONT_AND_BACK</span><span class="p">,</span> <span class="n">GL</span><span class="o">.</span><span class="n">GL_LINE</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glLineWidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">drawCube</span><span class="p">(</span><span class="n">FloatBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glPolygonMode</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_FRONT_AND_BACK</span><span class="p">,</span> <span class="n">GL</span><span class="o">.</span><span class="n">GL_FILL</span><span class="p">)</span>
        <span class="n">drawCube</span><span class="p">(</span><span class="n">FloatBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_BLEND</span><span class="p">)</span>
        
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glColor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCage</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drawCharacterHead</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.125</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">frames</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>

<div class="viewcode-block" id="PlayerSpawnPositionTool.drawCage"><a class="viewcode-back" href="../../editortools.html#editortools.player.PlayerSpawnPositionTool.drawCage">[docs]</a>    <span class="k">def</span> <span class="nf">drawCage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">cageTexVerts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pymclevel</span><span class="o">.</span><span class="n">MCInfdevOldLevel</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">blockTextures</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="n">pixelScale</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s">&quot;Alpha&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="n">texSize</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">pixelScale</span>
        <span class="n">cageTexVerts</span> <span class="o">=</span> <span class="n">cageTexVerts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">*</span> <span class="n">pixelScale</span>

        <span class="n">cageTexVerts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[((</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">),</span> <span class="p">(</span><span class="n">tx</span> <span class="o">+</span> <span class="n">texSize</span><span class="p">,</span> <span class="n">ty</span><span class="p">),</span> <span class="p">(</span><span class="n">tx</span> <span class="o">+</span> <span class="n">texSize</span><span class="p">,</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">texSize</span><span class="p">),</span> <span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">texSize</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span> <span class="ow">in</span>
             <span class="n">cageTexVerts</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float32&#39;</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_ALPHA_TEST</span><span class="p">)</span>

        <span class="n">drawCube</span><span class="p">(</span><span class="n">BoundingBox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">texture</span><span class="o">=</span><span class="n">pymclevel</span><span class="o">.</span><span class="n">alphaMaterials</span><span class="o">.</span><span class="n">terrainTexture</span><span class="p">,</span>
                 <span class="n">textureVertices</span><span class="o">=</span><span class="n">cageTexVerts</span><span class="p">)</span>
        <span class="n">GL</span><span class="o">.</span><span class="n">glDisable</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">GL_ALPHA_TEST</span><span class="p">)</span>
</div>
    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">mouseDown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">p</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerSpawnMoveOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>

        <span class="k">except</span> <span class="n">SpawnPositionInvalid</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&quot;Okay&quot;</span> <span class="o">!=</span> <span class="n">ask</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">responses</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Okay&quot;</span><span class="p">,</span> <span class="s">&quot;Fix it for me!&quot;</span><span class="p">]):</span>
                <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">level</span>
                <span class="n">status</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">okayAt63</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
                    <span class="n">level</span><span class="o">.</span><span class="n">setBlockAt</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">63</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">status</span> <span class="o">+=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Block added at y=63.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="mi">59</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">63</span><span class="p">:</span>
                    <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">63</span>
                    <span class="n">status</span> <span class="o">+=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Spawn point moved upward to y=63.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">okayAboveSpawn</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">63</span> <span class="ow">or</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">59</span><span class="p">:</span>
                        <span class="n">lpos</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">level</span><span class="o">.</span><span class="n">blockAt</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">level</span><span class="o">.</span><span class="n">blockAt</span><span class="p">(</span><span class="o">*</span><span class="n">lpos</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">okayAboveSpawn</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">lpos</span><span class="p">):</span>
                            <span class="n">pos</span> <span class="o">=</span> <span class="n">lpos</span>
                            <span class="n">status</span> <span class="o">+=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Spawn point shifted down by one block.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">okayAboveSpawn</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
                            <span class="n">level</span><span class="o">.</span><span class="n">setBlockAt</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

                            <span class="n">status</span> <span class="o">+=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Blocks above spawn point cleared.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">invalidateChunks</span><span class="p">([(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">16</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">//</span> <span class="mi">16</span><span class="p">)])</span>
                <span class="n">op</span> <span class="o">=</span> <span class="n">PlayerSpawnMoveOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addOperation</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">canUndo</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="o">.</span><span class="n">addUnsavedEdit</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markerList</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
                <span class="k">except</span> <span class="n">SpawnPositionInvalid</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">alert</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
                    <span class="n">alert</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Spawn point fixed. Changes: </span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">status</span><span class="p">)</span>

    <span class="nd">@alertException</span>
    <span class="k">def</span> <span class="nf">toolReselected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gotoSpawn</span><span class="p">()</span></div>
</pre></div>

                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../../index.html">MCEdit-Unified v1.5.6.0 documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="../../py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="../../genindex.html" title="General Index" >index</a></li>
        <li><a href="../index.html" >Module code</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2010-2014 David Rio Vierra (Codewarrior0). 2014-2016 MCEdit-Unified Team and all of the contributers. All Rights Reserved to their respective ownership..
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>